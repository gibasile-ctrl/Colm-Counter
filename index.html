<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Colm Counter</title>
<style>
  body { font-family: sans-serif; background:#0b1220; color:#e5e7eb; margin:0; padding:16px; }
  h1,h2{margin:8px 0;}
  .panel{background:#111827; padding:12px; border-radius:12px; margin-bottom:16px;}
  .controls{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px;}
  .btn{padding:8px 12px; border-radius:8px; border:none; cursor:pointer;}
  .good{background:#34d399; color:#0b1220;}
  .bad{background:#f43f5e; color:#0b1220;}
  .stat{margin:4px 0;}
  table{width:100%; border-collapse:collapse; margin-top:8px;}
  th,td{padding:6px; border-bottom:1px solid #243041; text-align:left;}
  .floor-bagger-row { background: #5f1a1a; color: #ffe5e5; font-weight: bold; }

  /* Live stats bars */
  .stats-bars div { margin:6px 0; color:#cbd5e1; display:flex; flex-direction:column; }
  .bar-container { display:flex; justify-content:space-between; align-items:center; }
  .bar { height:16px; background:#34d399; width:0%; border-radius:8px; transition: width 0.3s; margin-top:4px; }
  .bar.bad { background:#f43f5e; }
</style>
</head>
<body>

<h1>üèÜ Colm Counter</h1>

<!-- Player Setup -->
<div class="panel">
  <h2>Player</h2>
  <input id="player" placeholder="Enter name" />
  <div class="controls">
    <button class="btn" id="startBtn">Start Game</button>
    <button class="btn" id="endGameBtn">End Game</button>
  </div>
</div>

<!-- Log Throws -->
<div class="panel" id="throwPanel" style="display:none;">
  <h2>Log Throws</h2>
  <div class="controls">
    <button class="btn good" data-outcome="board">On board</button>
    <button class="btn good" data-outcome="hole">In hole</button>
    <button class="btn" data-outcome="miss">Miss</button>
    <button class="btn bad" data-outcome="frontfloor">Front‚Äëfloor üí•</button>
  </div>

  <!-- Live Stats with Percentages -->
  <div class="stats-bars">
    <div>
      <div class="bar-container"><span>Board</span><span id="boardPct">0%</span></div>
      <div class="bar" id="boardBar"></div>
    </div>
    <div>
      <div class="bar-container"><span>Hole</span><span id="holePct">0%</span></div>
      <div class="bar" id="holeBar"></div>
    </div>
    <div>
      <div class="bar-container"><span>Front-floor</span><span id="ffPct">0%</span></div>
      <div class="bar bad" id="ffBar"></div>
    </div>
  </div>

  <div class="stat">Throws: <span id="throwsLogged">0</span></div>
  <div class="stat">Front-floor faults: <span id="ffCount">0</span></div>
</div>

<!-- Game History -->
<div class="panel">
  <h2>Play History</h2>
  <table id="historyTbl">
    <thead>
      <tr><th>#</th><th>Player</th><th>Throws</th><th>FF</th><th>Floor Bagger?</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
(() => {
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  let state = { player:'', throws:[], ff:0 };
  const history = [];

  function refreshStats() {
    $('#throwsLogged').textContent = state.throws.length;
    $('#ffCount').textContent = state.ff;
    updateBars();
  }

  function addThrow(outcome) {
    state.throws.push(outcome);
    if(outcome === 'frontfloor') state.ff++;
    refreshStats();
  }

  function endGame() {
    if(!state.player) return alert('Start a game first!');
    if(!state.throws.length) return alert('No throws logged!');

    const floorBagger = state.throws.filter(t => t==='frontfloor').length >= 4;
    history.push({
      player: state.player,
      throws: state.throws.length,
      ff: state.ff,
      floorBagger
    });
    renderHistory();

    // Reset state for next game
    state.throws = [];
    state.ff = 0;
    refreshStats();
  }

  function renderHistory() {
    const tbody = $('#historyTbl tbody');
    tbody.innerHTML = '';
    history.forEach((g,i)=>{
      const tr = document.createElement('tr');
      if(g.floorBagger) tr.classList.add('floor-bagger-row'); // highlight row
      tr.innerHTML = `
        <td>${i+1}</td>
        <td>${g.player}</td>
        <td>${g.throws}</td>
        <td>${g.ff}</td>
        <td>${g.floorBagger?'Yes':'No'}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function updateBars() {
    const total = state.throws.length || 1;
    const counts = { board:0, hole:0, frontfloor:0 };
    state.throws.forEach(t=>{ if(counts[t]!==undefined) counts[t]++; });

    const boardPct = Math.round(counts.board/total*100);
    const holePct = Math.round(counts.hole/total*100);
    const ffPct = Math.round(counts.frontfloor/total*100);

    $('#boardBar').style.width = boardPct+'%';
    $('#holeBar').style.width = holePct+'%';
    $('#ffBar').style.width = ffPct+'%';

    $('#boardPct').textContent = boardPct+'%';
    $('#holePct').textContent = holePct+'%';
    $('#ffPct').textContent = ffPct+'%';
  }

  // Event listeners
  onTap($('#startBtn'), ()=>{
    const name = $('#player').value.trim();
    if(!name) return alert('Enter player name');
    state.player = name;
    $('#throwPanel').style.display = 'block';
    refreshStats();
  });

  onTap($('#endGameBtn'), endGame);

  $$('.controls button[data-outcome]').forEach(btn=>{
    onTap(btn, ()=> addThrow(btn.getAttribute('data-outcome')));
  });

  function onTap(el, handler) {
    ['click','touchend'].forEach(evt=>el.addEventListener(evt,e=>{e.preventDefault(); handler(e);},{passive:false}));
  }

})();
</script>

</body>
</html>
